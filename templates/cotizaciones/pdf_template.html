<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cotización Digital - Corpad</title>
    {% load static %}
    <style>
        @page {
            size: Letter;
            margin: 1.5cm;
        }
        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            color: #2D1B4B; /* Color base morado oscuro de tu app */
            font-size: 10pt;
            line-height: 1.4;
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }

        /* --- CONTENEDOR PRINCIPAL CON BORDE --- */
        .page-border {
            border: 1px solid #F3F4F6;
            border-radius: 2rem; /* El redondeado característico de tu app */
            padding: 30px;
            min-height: 95%;
            position: relative;
        }

        /* --- ENCABEZADO MODERNO --- */
        .header {
            display: table;
            width: 100%;
            margin-bottom: 30px;
            border-bottom: 2px solid #F3F4F6;
            padding-bottom: 20px;
        }
        .header-left { display: table-cell; vertical-align: middle; }
        .header-right { display: table-cell; vertical-align: middle; text-align: right; }

        .logo-img { height: 50px; width: auto; margin-bottom: 5px; }
        .brand-name { 
            font-size: 22pt; 
            font-weight: 900; 
            color: #2D1B4B; 
            letter-spacing: -1px; 
            margin: 0;
        }

        .folio-badge {
            background-color: #2D1B4B;
            color: white;
            padding: 5px 15px;
            border-radius: 1rem;
            font-size: 9pt;
            font-weight: bold;
            display: inline-block;
        }

        /* --- BLOQUE DE INFORMACIÓN (TARJETAS) --- */
        .info-grid {
            display: table;
            width: 100%;
            margin-bottom: 30px;
        }
        .info-card {
            display: table-cell;
            width: 50%;
            background-color: #F9FAFB;
            border-radius: 1.5rem;
            padding: 20px;
            border: 1px solid #F3F4F6;
        }
        .card-label {
            font-size: 8pt;
            font-weight: 800;
            color: #A855F7; /* Morado brillante */
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: block;
        }
        .client-name { font-weight: bold; font-size: 11pt; text-transform: uppercase; margin-bottom: 5px; }
        .client-detail { font-size: 9pt; color: #6B7280; line-height: 1.2; }

        /* --- TABLA DE SERVICIOS (ESTILO APP) --- */
        .table-container {
            border: 1px solid #F3F4F6;
            border-radius: 1.5rem;
            overflow: hidden;
            margin-bottom: 25px;
        }
        table { width: 100%; border-collapse: collapse; }
        th {
            background-color: #F9FAFB;
            color: #2D1B4B;
            padding: 12px 15px;
            text-align: left;
            font-size: 8pt;
            font-weight: 800;
            text-transform: uppercase;
            border-bottom: 1px solid #F3F4F6;
        }
        td { padding: 15px; border-bottom: 1px solid #F3F4F6; vertical-align: top; }
        .item-num { color: #A855F7; font-weight: bold; margin-right: 5px; }
        .item-title { font-weight: bold; color: #2D1B4B; font-size: 10pt; }
        .item-desc { font-size: 9pt; color: #6B7280; margin-top: 4px; }
        .price-col { text-align: right; font-weight: bold; color: #2D1B4B; font-size: 10pt; }

        /* --- RESUMEN DE COSTOS --- */
        .summary-card {
            background-color: #2D1B4B;
            color: white;
            border-radius: 1.5rem;
            padding: 25px;
            margin-top: 20px;
            display: block;
            text-align: right;
        }
        .summary-row { margin-bottom: 5px; }
        .total-label { font-size: 9pt; font-weight: bold; opacity: 0.8; }
        .total-amount { font-size: 18pt; font-weight: 900; color: #ffffff; }
        .discount-text { font-size: 8pt; color: #A855F7; font-weight: bold; margin-bottom: 10px; }

        /* --- FIRMA Y PIE --- */
        .footer-section {
            margin-top: 40px;
            text-align: center;
        }
        .signature-line {
            border-top: 2px solid #2D1B4B;
            width: 200px;
            margin: 40px auto 10px;
        }
        .contact-pill {
            background-color: #F3F4F6;
            padding: 10px;
            border-radius: 1rem;
            display: inline-block;
            margin-top: 20px;
            font-size: 8pt;
            font-weight: bold;
        }

    </style>
</head>
<body>

    <div class="page-border">
        
        <div class="header">
            <div class="header-left">
                <img src="{% static 'img/logo.png' %}" class="logo-img">
                <h1 class="brand-name">CORPAD</h1>
            </div>
            <div class="header-right">
                <div class="folio-badge">COTIZACIÓN #{{ c.id|stringformat:"04d" }}</div>
                <div style="font-size: 8pt; font-weight: bold; margin-top: 8px; color: #6B7280;">
                    Cuautitlán, Edo. Méx. | {% now "d/m/Y" %}
                </div>
            </div>
        </div>

        <div class="info-grid">
            <div class="info-card">
                <span class="card-label">Preparado para</span>
                <div class="client-name">{{ c.prospecto_empresa|default:c.prospecto_nombre|upper }}</div>
                <div class="client-detail">
                    {{ c.prospecto_direccion|default:"Domicilio no especificado" }}
                </div>
                <div class="attn-block">
                    <span style="font-size: 8pt; font-weight: bold; color: #2D1B4B;">AT'N:</span> 
                    <span style="font-size: 9pt; font-weight: bold;">{{ c.prospecto_nombre|upper }}</span>
                    <span style="font-size: 8pt; display: block; color: #6B7280;">{{ c.prospecto_cargo|default:"Representante Legal" }}</span>
                </div>
            </div>
            <div style="display: table-cell; width: 5%;"></div> <div class="info-card" style="background-color: white; border-color: #A855F7;">
                <span class="card-label">Mensaje</span>
                <p style="font-size: 8.5pt; margin: 0; color: #4B5563; text-align: justify;">
                    Me permito poner a sus órdenes los servicios de asesoría y gestoría de trámites administrativos ante el Ayuntamiento de Cuautitlán, para el legal funcionamiento del establecimiento al rubro citado:
                </p>
            </div>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th width="75%">Descripción del Trámite / Concepto</th>
                        <th width="25%" style="text-align: right;">Inversión</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in c.items.all %}
                    <tr>
                        <td>
                            <span class="item-title"><span class="item-num">{{ forloop.counter }}.</span> {{ item.servicio.nombre }}</span>
                            <div class="item-desc">
                                {{ item.descripcion_personalizada|default:item.servicio.descripcion }}
                            </div>
                        </td>
                        <td class="price-col">
                            $ {{ item.subtotal }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div style="margin-top: 20px;">
            <p style="font-size: 8.5pt; color: #6B7280; margin-bottom: 20px;">
                * Estos documentos serán entregados en original una vez recibidos por las dependencias correspondientes. El pago de derechos corre por cuenta del establecimiento.
            </p>

            <div class="summary-card">
                {% if c.descuento > 0 %}
                <div class="discount-text">
                    DESCUENTO POR RELACIÓN COMERCIAL: - $ {{ c.descuento }}
                </div>
                {% endif %}
                
                <div class="summary-row">
                    <span class="total-label">MONTO FINAL DE HONORARIOS</span>
                </div>
                <div class="summary-row">
                    <span class="total-amount">$ {{ c.total }}</span>
                    <span style="font-size: 9pt; font-weight: bold;">+ I.V.A.</span>
                </div>
                
                <p style="font-size: 7.5pt; opacity: 0.7; margin-top: 10px; font-style: italic;">
                    Condiciones: 50% anticipo y 50% contra entrega. Plazo estimado: 30 días hábiles.
                </p>
            </div>
        </div>

        <div class="footer-section">
            <div class="signature-line"></div>
            <div style="font-weight: 900; font-size: 11pt; text-transform: uppercase;">Lic. Maribel Aldana Santos</div>
            <div style="font-size: 8pt; font-weight: bold; color: #A855F7; text-transform: uppercase;">Directora General | Gestiones Corpad</div>
            
            <div class="contact-pill">
                <i class="fas fa-phone"></i> 55 9270 0722 &nbsp; | &nbsp; 
                <i class="fas fa-envelope"></i> ges.corpad@outlook.com &nbsp; | &nbsp; 
                <i class="fas fa-globe"></i> Cuautitlán, Edo. Méx.
            </div>
        </div>

        <div class="folio-footer">
            GC-COT-{{ c.id }}-{{ c.fecha_creacion|date:"Y" }}
        </div>
    </div>

</body>
</html>